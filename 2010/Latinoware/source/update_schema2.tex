\definecolor{000000}{rgb}{0.000,0.000,0.000}
\definecolor{0000BB}{rgb}{0.000,0.000,0.733}
\definecolor{FF8000}{rgb}{1.000,0.502,0.000}
\definecolor{007700}{rgb}{0.000,0.467,0.000}
\definecolor{DD0000}{rgb}{0.867,0.000,0.000}
\begin{noindent}{\color{000000} 
{\color{0000BB} }\\
{\color{0000BB} }}{\color{FF8000} //\hspace{0.1in}better\hspace{0.1in}approach\hspace{0.1in}(can\hspace{0.1in}run\hspace{0.1in}multiple\hspace{0.1in}instances\hspace{0.1in}safely)}\\
{\color{FF8000} }{\color{007700} while\hspace{0.1in}(}{\color{0000BB} true}{\color{007700} )\hspace{0.1in}\{}\\
{\color{007700} \hspace{0.1in}\hspace{0.1in}\hspace{0.1in}\hspace{0.1in}}{\color{0000BB} \$news\hspace{0.1in}}{\color{007700} =\hspace{0.1in}}{\color{0000BB} \$db}{\color{007700} ->}{\color{0000BB} command}{\color{007700} (array(}\\
{\color{007700} \hspace{0.1in}\hspace{0.1in}\hspace{0.1in}\hspace{0.1in}\hspace{0.1in}\hspace{0.1in}\hspace{0.1in}\hspace{0.1in}}{\color{DD0000} 'findAndModify'\hspace{0.1in}}{\color{007700} =>\hspace{0.1in}}{\color{DD0000} 'news'}{\color{007700} ,}\\
{\color{007700} \hspace{0.1in}\hspace{0.1in}\hspace{0.1in}\hspace{0.1in}\hspace{0.1in}\hspace{0.1in}\hspace{0.1in}\hspace{0.1in}}{\color{FF8000} //\hspace{0.1in}where\hspace{0.1in}url\hspace{0.1in}doesn't\hspace{0.1in}exists\hspace{0.1in}(much\hspace{0.1in}better\hspace{0.1in}than\hspace{0.1in}\$exists\hspace{0.1in}=>\hspace{0.1in}false)}\\
{\color{FF8000} \hspace{0.1in}\hspace{0.1in}\hspace{0.1in}\hspace{0.1in}\hspace{0.1in}\hspace{0.1in}\hspace{0.1in}\hspace{0.1in}}{\color{DD0000} 'query'\hspace{0.1in}}{\color{007700} =>\hspace{0.1in}array(}{\color{DD0000} 'url'\hspace{0.1in}}{\color{007700} =>\hspace{0.1in}}{\color{0000BB} null}{\color{007700} ),}\\
{\color{007700} \hspace{0.1in}\hspace{0.1in}\hspace{0.1in}\hspace{0.1in}\hspace{0.1in}\hspace{0.1in}\hspace{0.1in}\hspace{0.1in}}{\color{FF8000} //\hspace{0.1in}set\hspace{0.1in}a\hspace{0.1in}new\hspace{0.1in}value\hspace{0.1in}for\hspace{0.1in}url,\hspace{0.1in}diff\hspace{0.1in}than\hspace{0.1in}null}\\
{\color{FF8000} \hspace{0.1in}\hspace{0.1in}\hspace{0.1in}\hspace{0.1in}\hspace{0.1in}\hspace{0.1in}\hspace{0.1in}\hspace{0.1in}}{\color{DD0000} 'update'\hspace{0.1in}}{\color{007700} =>\hspace{0.1in}array(}{\color{DD0000} '\$set'\hspace{0.1in}}{\color{007700} =>\hspace{0.1in}array(}{\color{DD0000} 'url'\hspace{0.1in}}{\color{007700} =>\hspace{0.1in}}{\color{DD0000} '\hspace{0.1in}'}{\color{007700} )),}\\
{\color{007700} \hspace{0.1in}\hspace{0.1in}\hspace{0.1in}\hspace{0.1in}));}\\
{\color{007700} \hspace{0.1in}\hspace{0.1in}\hspace{0.1in}\hspace{0.1in}if\hspace{0.1in}(}{\color{0000BB} \$news}{\color{007700} [}{\color{DD0000} 'ok'}{\color{007700} ]\hspace{0.1in}!=\hspace{0.1in}}{\color{0000BB} 1}{\color{007700} )\hspace{0.1in}\hspace{0.1in}break;}\\
{\color{007700} \hspace{0.1in}\hspace{0.1in}\hspace{0.1in}\hspace{0.1in}}{\color{0000BB} \$query\hspace{0.1in}}{\color{007700} =\hspace{0.1in}array(}{\color{DD0000} '\_id'\hspace{0.1in}}{\color{007700} =>\hspace{0.1in}}{\color{0000BB} \$news}{\color{007700} [}{\color{DD0000} 'value'}{\color{007700} ][}{\color{DD0000} '\_id'}{\color{007700} ]):}\\
{\color{007700} \hspace{0.1in}\hspace{0.1in}\hspace{0.1in}\hspace{0.1in}}{\color{0000BB} \$update\hspace{0.1in}}{\color{007700} =\hspace{0.1in}array(}{\color{DD0000} '\$set'\hspace{0.1in}}{\color{007700} =>\hspace{0.1in}array(}{\color{DD0000} 'url'\hspace{0.1in}}{\color{007700} =>\hspace{0.1in}}{\color{0000BB} get\_url\_from\_title}{\color{007700} (}{\color{0000BB} \$news}{\color{007700} [}{\color{DD0000} 'value'}{\color{007700} ][}{\color{DD0000} 'title'}{\color{007700} ])));}\\
{\color{007700} \hspace{0.1in}\hspace{0.1in}\hspace{0.1in}\hspace{0.1in}}{\color{0000BB} \$db}{\color{007700} ->}{\color{0000BB} news}{\color{007700} ->}{\color{0000BB} update}{\color{007700} (}{\color{0000BB} \$query}{\color{007700} ,\hspace{0.1in}}{\color{0000BB} \$update}{\color{007700} );}\\
{\color{007700} \}}\\
{\color{007700} }

\end{noindent}
